# EAS Build & Deployment Guide for Charisma Tracker

## Prerequisites

1. **Install EAS CLI globally:**
   ```bash
   npm install -g eas-cli
   ```

2. **Login to your Expo account:**
   ```bash
   eas login
   ```

3. **Configure your project:**
   ```bash
   eas init
   ```
   This will generate a project ID and update your `app.json` automatically.

## Configuration Steps

### 1. Update app.json
Replace the placeholder values in `app.json`:
- `"owner": "your-expo-username"` → Your Expo username
- `"projectId": "your-project-id-here"` → Will be auto-generated by `eas init`
- `"bundleIdentifier": "com.yourcompany.charismatracker"` → Your iOS bundle ID
- `"package": "com.yourcompany.charismatracker"` → Your Android package name

### 2. Build Profiles

The `eas.json` file contains three build profiles:

#### **Development Build**
For testing with Expo Go or development client:
```bash
eas build --profile development --platform android
eas build --profile development --platform ios
```

#### **Preview Build**
For internal testing (APK for Android, Ad Hoc for iOS):
```bash
eas build --profile preview --platform android
eas build --profile preview --platform ios
```

#### **Production Build**
For App Store/Play Store submission:
```bash
eas build --profile production --platform android
eas build --profile production --platform ios
```

## Building Your App

### Android Build
```bash
# Development APK
eas build --profile development --platform android

# Preview APK (for testing)
eas build --profile preview --platform android

# Production APK/AAB
eas build --profile production --platform android
```

### iOS Build
```bash
# Development build
eas build --profile development --platform ios

# Preview build (Ad Hoc)
eas build --profile preview --platform ios

# Production build (App Store)
eas build --profile production --platform ios
```

### Build Both Platforms
```bash
eas build --profile production --platform all
```

## Submission to Stores

### Android (Google Play Store)

1. **Configure submission in eas.json:**
   - Update `serviceAccountKeyPath` with your Google Service Account JSON key
   - Choose track: `internal`, `alpha`, `beta`, or `production`

2. **Submit:**
   ```bash
   eas submit --platform android
   ```

### iOS (Apple App Store)

1. **Configure submission in eas.json:**
   - Update `appleId` with your Apple ID email
   - Update `ascAppId` with your App Store Connect app ID
   - Update `appleTeamId` with your Apple Developer Team ID

2. **Submit:**
   ```bash
   eas submit --platform ios
   ```

## Over-The-Air (OTA) Updates

After your app is published, you can push updates without rebuilding:

```bash
eas update --branch production --message "Bug fixes and improvements"
```

## Useful Commands

```bash
# Check build status
eas build:list

# View build logs
eas build:view [BUILD_ID]

# Cancel a build
eas build:cancel [BUILD_ID]

# Configure credentials
eas credentials

# View project info
eas project:info
```

## Environment Variables

To add environment variables for builds, create a `.env` file and reference it in `eas.json`:

```json
{
  "build": {
    "production": {
      "env": {
        "API_URL": "https://api.yourapp.com"
      }
    }
  }
}
```

## Troubleshooting

### Common Issues

1. **Build fails with "No bundle identifier":**
   - Make sure `bundleIdentifier` (iOS) and `package` (Android) are set in `app.json`

2. **Credentials issues:**
   - Run `eas credentials` to manage iOS/Android credentials

3. **Build timeout:**
   - Increase `resourceClass` in `eas.json` (e.g., `"m-large"`)

4. **Dependencies issues:**
   - Ensure all dependencies are compatible with Expo SDK 54

## Resources

- [EAS Build Documentation](https://docs.expo.dev/build/introduction/)
- [EAS Submit Documentation](https://docs.expo.dev/submit/introduction/)
- [EAS Update Documentation](https://docs.expo.dev/eas-update/introduction/)
- [Expo Application Services](https://expo.dev/eas)

## Next Steps

1. Run `eas init` to configure your project
2. Update placeholder values in `app.json`
3. Run your first build: `eas build --profile preview --platform android`
4. Test the build on a device
5. When ready, build for production and submit to stores
